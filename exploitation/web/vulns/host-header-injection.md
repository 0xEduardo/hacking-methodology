# Host Header Injection

Typically host header injection are not harmful by themselves, it is necessary a chain of vulnerabilites for it to escalate.

- Business Logic flaws
- Cache poisoning

## Attack Vectors

> **Premise:** An websites allows an user to remember his passwords by requesting a reset email. Attack vector: An attacker request the reset for an email that the knows the application exists, he intercepts the request and adds a host `X-Forwarded-For: evil.com`

If the attack is successful, the user will receive an email that will direct to evil.com

## Headi

```
# https://github.com/mlcsec/headi
headi -url http://exmaple.com
```

## Common Headers

[https://gist.github.com/felipecaon/313a6fb6f1c5273bd61169fba920016f](https://gist.github.com/felipecaon/313a6fb6f1c5273bd61169fba920016f)

```
# Fake Origin - make GET request to accesible endpoint with:
X-Original-URL: /admin
X-Override-URL: /admin
X-Rewrite-URL: /admin
Referer: /admin
```

Override Headers:

- X-Forwarded-Host
- X-HTTP-Host-Override
- Forwarded
- X-Host
- X-Forwarded-Server

Generating a wordlist for Fuzzing:

Code: bash

```bash
for a in {1..255};do
    for b in {1..255};do
        echo "192.168.$a.$b" >> ips.txt
    done
done
```

Using ffuf to fuzz the host header:

Code: bash

```bash
ffuf -u http://IP:PORT/admin.php -w ips.txt -H 'Host: FUZZ'
```

Bypassing blacklist filters for `localhost`:

- Decimal encoding: `2130706433`
- Hex encoding: `0x7f000001`
- Octal encoding: `0177.0000.0000.0001`
- Zero: `0`
- Short form: `127.1`
- IPv6: `::1`
- External domain that resolves to localhost: `localtest.me`
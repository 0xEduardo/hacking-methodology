# Prototype Pollution

#### Exploitation

- Vulnerable NodeJS libraries: [here](https://raw.githubusercontent.com/HoLyVieR/prototype-pollution-nsec18/master/paper/JavaScript_prototype_pollution_attack_in_NodeJS.pdf)
- Access prototype of an object via `__proto__` or `constructor.prototype` property
- Client-side prototype pollution vulnerabilities: [here](https://github.com/BlackFan/client-side-prototype-pollution)
- Safe Identification: [here](https://portswigger.net/research/server-side-prototype-pollution)
    - Status Code: `__proto__.status`
    - Parameter Limit: `__proto__.parameterLimit`
    - Content-Type: `__proto__.content-type`

- [https://github.com/BlackFan/client-side-prototype-pollution](https://github.com/BlackFan/client-side-prototype-pollution)
- [https://github.com/msrkp/PPScan](https://github.com/msrkp/PPScan)

## Where to find?

- Javascript driven frameworks (Express..)

### PHP

PHP internally uses parse_str() to parse parameters so it sees the char “[” & “_” as the same. PHP by default will use the last param as valid. In cases PHP is running on backend but front end validates the param, we can smuggle fake params to php

```html
example.com?account_id=gust&account[id=admin

# Backend would execute guest and frontend admin 
```

#### Talks

[https://www.youtube.com/watch?v=LUsiFV3dsK8](https://www.youtube.com/watch?v=LUsiFV3dsK8)

#### Prevention

- Check user-supplied properties against a whitelist
- Freeze prototype by calling `Object.freeze()`
- Create object without prototype with `Object.create(null)`